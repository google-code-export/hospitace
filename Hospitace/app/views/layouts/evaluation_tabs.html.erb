
<%
@evaluation ||= Evaluation.find params[:evaluation_id] unless params[:evaluation_id].nil?
@observation = @evaluation.observation  
%>

<% content_for :tab do %>
  <ul class="nav nav-tabs">
    <%= tab_item(:observation,@evaluation) if can? :show, @evaluation %>  
    <%= sub_tab(:setting,:setting,"Setting") do %>
      <%= tab_item(:information,edit_evaluation_path(@evaluation),:manage,@evaluation) %>
      <%= tab_item(:attachments,evaluation_attachments_path(@evaluation),:show, @observation) %> 
      <%= tab_item(:forms,evaluation_forms_path(@evaluation),:manage,Form) %>
    <% end %>

    <% FormTemplate.all.each do |template| %>
      <%= form_tab(template,@evaluation) %>
      <% break if !template.count?(@evaluation) and template.required %>
      
    <% end %>

  </ul>
<% end %>

<% content_for :content do %>
  <%= message( t("observation.warning"),@observation.state.long_message,@observation.state.actions) if !@observation.state.ok? && can?(:update,@observation) %>
  <%= content_for?(:news_content) ? yield(:news_content) : yield %>
<% end %>
<%= render :template => 'layouts/application' %>